pico-8 cartridge // http://www.pico-8.com
version 32
__lua__

greenParticles = {}
offset = 0
isStarting = 0
distance = 48
width = 64

function _init()
    for x = 0, 500 do
        add(greenParticles, { pos = rnd(8), speed = 0.2 + rnd(1.5), distanceOffset = rnd(6), color = rColor()})
    end
    music(0)
end

function _update60()
    if(isStarting == 0 and btn(4,1)) then 
        isStarting += 0.1 
    elseif(isStarting > 0) then
        isStarting += 0.1
        if(isStarting) < 6 then
            distance -= 0.1
        end
        if(isStarting > 6) then
            distance += 1
            width += 0.5
        end
        if(isStarting > 10) then
            load("Doom2D")
            run()
        end
    end
end

function _draw()
    cls()
    color(6)
    print('golfenstein', 42, 60)
    print('3d', 60, 70)
    offset = (offset + 0.001) % 100
    drawPixel(11)
end

function drawPixel(color)
    foreach(greenParticles, 
        function(obj)
            pset(
                64 + cos(obj.pos + offset * obj.speed) * (distance + sin(offset * obj.distanceOffset) * (width-distance)), 
                64 + sin(obj.pos + offset * obj.speed) * (distance + sin(offset * obj.distanceOffset) * (width-distance)), 
                obj.color
            )
        end
    )
end

function rColor()
    local c = {3, 8, 11, 11, 11, 11, 2}
    return c[flr(1+rnd(#c))]
end

__sfx__
301000200b4300b410006000b450006001a100267001960025700186001441014410104100e4100e4101f100004200c4101a1000c420186001b100267001860002420024100b43021700176000c4302050017500
301000000b4300b4101c1100b450196001a140267201960025750186002872026750196000c4101533015320267400c4101a1100c420186001b12026720186001b130186000b43026710176001f1202674026730
301000000b4300b4101c1100b450131101a1401001010010104101a12007010070200a0200c4101533015320090100c4100c3300c420090100c320090100901018120181100b4100701017110171200701007020
b61000002313023110231202311000000000000000000000000000000000000000002313023110231202311024130241202413024110128001580017800000001f1301f1101f1201f1100c310113201533018340
8e1000003c610376001b6201b610326502f6101b60032640396103263007620016203265032610316003060037610376001b6201b610326502f6101b600326403961032630076200162032650326202b61036620
96100000174101742017440174401441014420144301443013410134201344013430124101242012430124400b4000b4100b4200b4100b4000b4100b4200b4100b4000b4100b4200b4100b4100e4301144013450
0001000009070060600133000070000700006005540055300553007520095200a5200b5200c5300f53010530105200250002500025000250002500025000250002500015000150000500005000e0000e0000d000
000200000f6102d620376303a6203c6203961034610306102b61034330236101e6101a61016610126100d6101d3200361000610276001b5002610019600000000d60000600056000000000000000000000000000
000300000007004670046700303002670016700064000620006101e50006600056000460004600036000060000600006000060000600006000060000000000000000000000000000000000000000000000000000
00020000121701a560220500002000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0003000000450014501861011450004500d630004500005000050000500f6500004001040010400204002040030400404005030070300a0200b1200b2200b0300b2300b0300b0300b0300b0200b2100b0100b410
001000002f2102e7402d4202b130247501a7500874002730001200012000020004100041000010001100011000010001100011000110001300014000000000000000000000000000000000000000000000000000
__music__
00 01434441
00 02034344
00 02040144
00 01040045
00 01044305
00 02400405
00 00424305
02 00420405