pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
game = {}
game.time = 0
game.objects = {}

function _init()
	createEntity(20, 20, {4})
end

function _update()
	game.time += 1
	for index, value in ipairs(game.objects) do

	end
end

function _draw()
	cls()
	spr(mapitem.sprites[mapitem.spriteIndex],mapitem.x,mapitem.y)
end

function createEntity(x, y, sprites)
	local entity = {}
	entity.x = x
	entity.y = y
	entity.sprite = sprites[0]
	entity.draw = nil
	entity.components = {}
	entity.components[1] = createPlayerController()
	entity.components[2] = createSpriteAnimator(sprites)
	entity.draw = entity.components[2].draw
	table.insert(game.objects, entity)
	return entity
end

function createSpriteAnimator(sprites)
	local animator = {}
	animator.sprites = sprites
	animator.spriteIndex = 1
	function animator:update(owner)
		if(game.time % 10 = 0) then
			spriteIndex += 1
			if(spriteIndex > count(sprites)) then 
				spriteIndex = 1 
			end
			owner.sprite = sprites[spriteIndex]
		end
	end
	function animator:draw(owner)
		spr()
	end
end

function createPlayerController()
	local controller = {}
	controller.speed = 2
	function controller:update(owner)
		if(btn(0)) then owner.x-=speed end
		if(btn(1)) then owner.x+=speed end
		if(btn(2)) then owner.y-=speed end
		if(btn(3)) then owner.y+=speed end
	end
	return controller
end


__gfx__
77777777777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000070000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000070000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777770000700070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000700070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000700070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000700070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000700070000000550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000700070000000550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70007777777700070000009559000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000000070000009999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000000070000009999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000000070000000999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000000070000000099900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777777777770000000099900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
